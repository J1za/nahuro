import { useState } from 'react';
import omitBy from 'lodash/omitBy';
import Grid from '@mui/material/Grid';
import { PropertyCard, PropertyVariant } from 'features/property';
import { useGetPropertiesQuery } from 'store';
import CircularProgress from '@mui/material/CircularProgress';

import Filter, { FilterData } from '../components/Filter/Filter';
import IndexTokenPromo from 'components/IndexTokenPromo/IndexTokenPromo';

export const CatalogPage = () => {
  const [requestParams, setRequestParams] = useState({});

  const onSubmit = (data: FilterData) => {
    setRequestParams(omitBy(data, value => value === ''));
  };

  const { data = [], isLoading, isFetching } = useGetPropertiesQuery(requestParams);

  return (
    <div className="block-marketplace">
      <div className="container">
        {/* <ReturnBtn text="back to main" /> */}
        {/* <div className='return-btn'>back to main</div> */}
        <div className="block-head">
          <h1 className="page-title">Property MarketPlace</h1>
          <div className="marketplace-stats">
            <div className="stat-item">
              <div className="stat-item-title">Total value of property portfolio</div>
              <div className="stat-item-value">$54,445,623</div>
            </div>
            <div className="stat-item">
              <div className="stat-item-title">Total daily returns:</div>
              <div className="stat-item-value">$655,667</div>
            </div>
            <div className="stat-item">
              <div className="stat-item-title">Total number of tokens sold:</div>
              <div className="stat-item-value">657,455</div>
            </div>
            <div className="stat-item">
              <div className="stat-item-title">Total number of investors:</div>
              <div className="stat-item-value">54,878</div>
            </div>
          </div>
        </div>

        <Filter onSubmit={onSubmit} />

        <div className="block-marketplace_promo">
          <IndexTokenPromo />
        </div>

        <div className="property-list">
          {isFetching && (
            <div className="property-list-loader">
              <CircularProgress color="primary" />
            </div>
          )}

          {!isLoading && !data.length && <div className="no-data-found">No data found</div>}

          <Grid container spacing={4}>
            {data.map(item => (
              <Grid item xs={12} sm={6} md={4} key={item.id}>
                <PropertyCard data={item} variant={PropertyVariant.SECONDARY} />
              </Grid>
            ))}
          </Grid>
        </div>
      </div>

      {/*нужно перенести в глобальную видимость */}
      <div className="sprite">
        <svg fill="none" xmlns="http://www.w3.org/2000/svg">
          <symbol viewBox="0 0 185 41" id="logo">
            <path
              d="M64.272 40.0365V8.90175H68.2161V22.1888H85.2066V8.90175H89.1511V40.0365H85.2066V26.0477H68.2161V40.0365H64.272Z"
              fill="#1B1B1B"
            />
            <path
              d="M100.363 37.0987C102.645 39.2913 105.607 40.3874 109.248 40.3874C112.889 40.3874 115.836 39.2913 118.09 37.0987C120.373 34.906 121.514 31.9386 121.514 28.1965V8.90173H117.57V28.3719C117.57 31.0032 116.819 33.0347 115.316 34.4674C113.813 35.8705 111.791 36.5723 109.248 36.5723C106.705 36.5723 104.682 35.8705 103.18 34.4674C101.677 33.0347 100.926 31.0032 100.926 28.3719V8.90173H96.9819V28.1965C96.9819 31.9386 98.1089 34.906 100.363 37.0987ZM115.706 0L110.808 6.35863H107.644L110.982 0H115.706Z"
              fill="#1B1B1B"
            />
            <path
              d="M129.371 40.0365V8.90175H138.517C141.522 8.90175 143.92 9.70603 145.712 11.3137C147.503 12.8923 148.399 15.012 148.399 17.6723C148.399 19.6895 147.807 21.4874 146.622 23.066C145.437 24.6446 143.588 25.6825 141.074 26.1793L151.736 40.0365H146.969L136.696 26.4425H133.316V40.0365H129.371ZM133.316 22.8906H138.257C140.251 22.8906 141.753 22.4519 142.764 21.5752C143.805 20.6688 144.325 19.3973 144.325 17.7601C144.325 16.0938 143.805 14.8218 142.764 13.945C141.753 13.0386 140.251 12.5853 138.257 12.5853H133.316V22.8906Z"
              fill="#1B1B1B"
            />
            <path
              d="M180.449 35.8266C177.415 38.867 173.688 40.3874 169.266 40.3874C164.845 40.3874 161.118 38.867 158.084 35.8266C155.05 32.7572 153.533 28.9712 153.533 24.4691C153.533 19.967 155.05 16.1957 158.084 13.1554C161.118 10.086 164.845 8.55124 169.266 8.55124C173.688 8.55124 177.415 10.086 180.449 13.1554C183.483 16.1957 185 19.967 185 24.4691C185 28.9712 183.483 32.7572 180.449 35.8266ZM160.901 33.1081C163.126 35.4175 165.915 36.5723 169.266 36.5723C172.618 36.5723 175.407 35.4175 177.632 33.1081C179.856 30.7691 180.969 27.8894 180.969 24.4691C180.969 21.0488 179.856 18.1838 177.632 15.8744C175.407 13.5354 172.618 12.3663 169.266 12.3663C165.915 12.3663 163.126 13.5354 160.901 15.8744C158.676 18.1838 157.564 21.0488 157.564 24.4691C157.564 27.8894 158.676 30.7691 160.901 33.1081Z"
              fill="#1B1B1B"
            />
            <path
              fillRule="evenodd"
              clipRule="evenodd"
              d="M22.7548 30.9598L16.5022 24.711L16.502 29.9371L22.7548 36.2075L26.4895 39.9527L26.4898 39.9531L26.4895 39.9149V8.68547H22.7548V30.9598Z"
              fill="#1B1B1B"
            />
            <path
              fillRule="evenodd"
              clipRule="evenodd"
              d="M3.735 17.6788L9.98764 23.9272L9.98786 18.7015L3.735 12.4311V12.4306L0.000255122 8.68547V8.68591L0 8.68547L0.000255122 8.72369V39.9531H3.735V17.6788Z"
              fill="#1B1B1B"
            />
            <path
              fillRule="evenodd"
              clipRule="evenodd"
              d="M35.9846 28.2278L30.3342 39.9531H34.5901L38.4117 31.8757H52.3086L56.1302 39.9531H60.3861L54.7353 28.2278H50.5711H50.5715H40.1488H40.1488H35.9846Z"
              fill="#1B1B1B"
            />
            <path d="M39.4319 23.2335L45.3811 11.9455L51.3302 23.2335H39.4319Z" stroke="#1B1B1B" strokeWidth="3" />
          </symbol>

          <symbol viewBox="0 0 22 22" id="icon-facebook">
            <path
              d="M22 11C22 4.92486 17.0751 0 11 0C4.92486 0 0 4.92486 0 11C0 16.4903 4.02252 21.0412 9.28125 21.8664V14.1797H6.48828V11H9.28125V8.57656C9.28125 5.81969 10.9235 4.29688 13.4361 4.29688C14.6392 4.29688 15.8984 4.51172 15.8984 4.51172V7.21875H14.5114C13.145 7.21875 12.7188 8.06674 12.7188 8.9375V11H15.7695L15.2818 14.1797H12.7188V21.8664C17.9775 21.0412 22 16.4903 22 11Z"
              fill="#1877F2"
            />
            <path
              d="M15.2818 14.1797L15.7695 11H12.7188V8.9375C12.7188 8.0676 13.145 7.21875 14.5114 7.21875H15.8984V4.51172C15.8984 4.51172 14.6397 4.29688 13.4361 4.29688C10.9235 4.29688 9.28125 5.81969 9.28125 8.57656V11H6.48828V14.1797H9.28125V21.8664C10.4202 22.0445 11.5798 22.0445 12.7188 21.8664V14.1797H15.2818Z"
              fill="white"
            />
          </symbol>

          <symbol viewBox="0 0 22 22" id="icon-twitter">
            <path
              d="M6.91856 19.9381C15.2205 19.9381 19.7613 13.06 19.7613 7.09539C19.7613 6.90003 19.7613 6.70555 19.7481 6.51195C20.6315 5.87299 21.394 5.08185 22 4.17555C21.1763 4.54075 20.3024 4.78014 19.4075 4.88571C20.3498 4.32168 21.0551 3.43443 21.3919 2.38915C20.5059 2.91496 19.5366 3.28549 18.5258 3.48475C17.8452 2.76111 16.9452 2.28194 15.9648 2.12138C14.9845 1.96082 13.9786 2.12782 13.1028 2.59655C12.227 3.06528 11.53 3.80959 11.1198 4.71432C10.7097 5.61905 10.6091 6.63374 10.8337 7.60139C9.03915 7.51137 7.28361 7.045 5.681 6.23256C4.07839 5.42011 2.66453 4.27974 1.5312 2.88547C0.954001 3.87913 0.777216 5.05543 1.03684 6.17486C1.29647 7.29429 1.97298 8.27268 2.92864 8.91083C2.2103 8.88978 1.50759 8.696 0.88 8.34587V8.40307C0.880285 9.44519 1.24103 10.4551 1.90105 11.2616C2.56107 12.068 3.47972 12.6214 4.5012 12.8277C3.83669 13.009 3.13947 13.0355 2.46312 12.9052C2.75166 13.802 3.31323 14.5862 4.0693 15.1482C4.82538 15.7102 5.73817 16.0219 6.68008 16.0397C5.74424 16.7753 4.67254 17.3192 3.5263 17.6402C2.38006 17.9612 1.18178 18.0531 0 17.9106C2.06418 19.2352 4.46593 19.9378 6.91856 19.9346"
              fill="#1DA1F2"
            />
          </symbol>

          <symbol viewBox="0 0 22 22" id="icon-instagram">
            <path
              d="M11 1.98086C13.9391 1.98086 14.2871 1.99375 15.443 2.04531C16.5172 2.09258 17.0973 2.27305 17.484 2.42344C17.9953 2.62109 18.3648 2.86172 18.7473 3.24414C19.134 3.63086 19.3703 3.99609 19.568 4.50742C19.7183 4.89414 19.8988 5.47851 19.9461 6.54844C19.9976 7.70859 20.0105 8.05664 20.0105 10.9914C20.0105 13.9305 19.9976 14.2785 19.9461 15.4344C19.8988 16.5086 19.7183 17.0887 19.568 17.4754C19.3703 17.9867 19.1297 18.3562 18.7473 18.7387C18.3605 19.1254 17.9953 19.3617 17.484 19.5594C17.0973 19.7098 16.5129 19.8902 15.443 19.9375C14.2828 19.9891 13.9348 20.0019 11 20.0019C8.06093 20.0019 7.71289 19.9891 6.55703 19.9375C5.48281 19.8902 4.90273 19.7098 4.51601 19.5594C4.00469 19.3617 3.63515 19.1211 3.25273 18.7387C2.86601 18.3519 2.62969 17.9867 2.43203 17.4754C2.28164 17.0887 2.10117 16.5043 2.05391 15.4344C2.00234 14.2742 1.98945 13.9262 1.98945 10.9914C1.98945 8.05234 2.00234 7.70429 2.05391 6.54844C2.10117 5.47422 2.28164 4.89414 2.43203 4.50742C2.62969 3.99609 2.87031 3.62656 3.25273 3.24414C3.63945 2.85742 4.00469 2.62109 4.51601 2.42344C4.90273 2.27305 5.48711 2.09258 6.55703 2.04531C7.71289 1.99375 8.06093 1.98086 11 1.98086ZM11 0C8.01367 0 7.63984 0.0128906 6.46679 0.0644531C5.29804 0.116016 4.49453 0.305078 3.79844 0.575781C3.07226 0.859375 2.45781 1.2332 1.84766 1.84766C1.2332 2.45781 0.859375 3.07227 0.575781 3.79414C0.305078 4.49453 0.116016 5.29375 0.0644531 6.4625C0.0128906 7.63984 0 8.01367 0 11C0 13.9863 0.0128906 14.3602 0.0644531 15.5332C0.116016 16.702 0.305078 17.5055 0.575781 18.2016C0.859375 18.9277 1.2332 19.5422 1.84766 20.1523C2.45781 20.7625 3.07226 21.1406 3.79414 21.4199C4.49453 21.6906 5.29375 21.8797 6.4625 21.9312C7.63554 21.9828 8.00937 21.9957 10.9957 21.9957C13.982 21.9957 14.3559 21.9828 15.5289 21.9312C16.6976 21.8797 17.5012 21.6906 18.1973 21.4199C18.9191 21.1406 19.5336 20.7625 20.1437 20.1523C20.7539 19.5422 21.132 18.9277 21.4113 18.2059C21.682 17.5055 21.8711 16.7062 21.9226 15.5375C21.9742 14.3645 21.9871 13.9906 21.9871 11.0043C21.9871 8.01797 21.9742 7.64414 21.9226 6.47109C21.8711 5.30234 21.682 4.49883 21.4113 3.80273C21.1406 3.07226 20.7668 2.45781 20.1523 1.84766C19.5422 1.2375 18.9277 0.859375 18.2059 0.580078C17.5055 0.309375 16.7062 0.120312 15.5375 0.06875C14.3601 0.0128906 13.9863 0 11 0Z"
              fill="#EC3397"
            />
            <path
              d="M11 5.34961C7.88047 5.34961 5.34961 7.88047 5.34961 11C5.34961 14.1195 7.88047 16.6504 11 16.6504C14.1195 16.6504 16.6504 14.1195 16.6504 11C16.6504 7.88047 14.1195 5.34961 11 5.34961ZM11 14.6652C8.97617 14.6652 7.33477 13.0238 7.33477 11C7.33477 8.97617 8.97617 7.33477 11 7.33477C13.0238 7.33477 14.6652 8.97617 14.6652 11C14.6652 13.0238 13.0238 14.6652 11 14.6652Z"
              fill="#EC3397"
            />
            <path
              d="M18.193 5.1262C18.193 5.85667 17.6 6.44535 16.8738 6.44535C16.1434 6.44535 15.5547 5.85238 15.5547 5.1262C15.5547 4.39573 16.1477 3.80706 16.8738 3.80706C17.6 3.80706 18.193 4.40003 18.193 5.1262Z"
              fill="#EC3397"
            />
          </symbol>

          <symbol viewBox="0 0 22 22" id="icon-linkedin">
            <path
              d="M20.376 0H1.62403C1.19331 0 0.780231 0.171103 0.475667 0.475667C0.171103 0.780231 0 1.19331 0 1.62403V20.376C0 20.8067 0.171103 21.2198 0.475667 21.5243C0.780231 21.8289 1.19331 22 1.62403 22H20.376C20.8067 22 21.2198 21.8289 21.5243 21.5243C21.8289 21.2198 22 20.8067 22 20.376V1.62403C22 1.19331 21.8289 0.780231 21.5243 0.475667C21.2198 0.171103 20.8067 0 20.376 0ZM6.55722 18.7413H3.24958V8.23472H6.55722V18.7413ZM4.90111 6.77875C4.52592 6.77664 4.15976 6.66343 3.84884 6.45341C3.53792 6.2434 3.29619 5.94599 3.15414 5.59871C3.01209 5.25144 2.97609 4.86988 3.0507 4.50217C3.1253 4.13446 3.30715 3.79709 3.57331 3.53263C3.83947 3.26818 4.178 3.08849 4.54618 3.01626C4.91436 2.94402 5.29569 2.98246 5.64204 3.12674C5.98839 3.27101 6.28424 3.51465 6.49226 3.82691C6.70027 4.13917 6.81113 4.50605 6.81083 4.88125C6.81437 5.13245 6.7673 5.38179 6.67243 5.6144C6.57755 5.84702 6.43682 6.05816 6.25861 6.23523C6.0804 6.4123 5.86836 6.55168 5.63514 6.64505C5.40192 6.73843 5.15228 6.7839 4.90111 6.77875ZM18.7489 18.7504H15.4428V13.0106C15.4428 11.3178 14.7232 10.7953 13.7943 10.7953C12.8135 10.7953 11.851 11.5347 11.851 13.0533V18.7504H8.54333V8.24236H11.7242V9.69833H11.7669C12.0863 9.05208 13.2046 7.9475 14.9111 7.9475C16.7567 7.9475 18.7504 9.04292 18.7504 12.2513L18.7489 18.7504Z"
              fill="#0A66C2"
            />
          </symbol>

          <symbol viewBox="0 0 21 20" id="icon-heart">
            <path
              d="M15.1875 0.125C13.375 0.125 11.6354 0.96875 10.5 2.30208C9.36459 0.96875 7.62501 0.125 5.81251 0.125C2.60418 0.125 0.0833435 2.64583 0.0833435 5.85417C0.0833435 9.79167 3.62501 13 8.98959 17.875L10.5 19.2396L12.0104 17.8646C17.375 13 20.9167 9.79167 20.9167 5.85417C20.9167 2.64583 18.3958 0.125 15.1875 0.125ZM10.6042 16.3229L10.5 16.4271L10.3958 16.3229C5.43751 11.8333 2.16668 8.86458 2.16668 5.85417C2.16668 3.77083 3.72918 2.20833 5.81251 2.20833C7.41668 2.20833 8.97918 3.23958 9.53126 4.66667H11.4792C12.0208 3.23958 13.5833 2.20833 15.1875 2.20833C17.2708 2.20833 18.8333 3.77083 18.8333 5.85417C18.8333 8.86458 15.5625 11.8333 10.6042 16.3229Z"
              fill="white"
            />
          </symbol>

          <symbol viewBox="0 0 24 24" id="icon-select-circle-check">
            <circle cx="12" cy="12" r="10" fill="#1994D9" />
            <path
              d="M16.59 8.29492L12 12.8749L7.41 8.29492L6 9.70492L12 15.7049L18 9.70492L16.59 8.29492Z"
              fill="white"
            />
          </symbol>
        </svg>
      </div>
    </div>
  );
};
